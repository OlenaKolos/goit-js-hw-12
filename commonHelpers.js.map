{"version":3,"file":"commonHelpers.js","sources":["../src/img/alert.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__0a4fe6ce__\"","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport alertImg from '/img/alert.svg';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst getMoreBtn =\n  document.querySelector('.get-more-btn') || document.createElement('button');\n\nconst photoLoader = {\n  url: 'https://pixabay.com/api/',\n  searchParams: {\n    key: '40878457-91c7c8077e8a58c5727309d44',\n    q: '',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 40,\n    page: 1,\n  },\n  searchPhotosBtn: document.querySelector('.search-btn'),\n  searchTerm: document.querySelector('.searchTerm'),\n  loader: document.querySelector('.loader'),\n  gallery: document.querySelector('.gallery'),\n  totalHits: 0,\n\n  simpleGallery: new SimpleLightbox('.gallery a', {\n    overlayOpacity: 0.8,\n    captionsData: 'alt',\n    captionDelay: 250,\n  }),\n\n  startSearch(event) {\n    event.preventDefault();\n    if (this.searchTerm.value.trim().length < 3) {\n      this.showAlert('Please, enter search term!');\n      return;\n    }\n    this.gallery.innerHTML = '';\n    this.searchParams.q = this.searchTerm.value.trim();\n    this.searchParams.page = 1;\n    this.fetchPhotos();\n  },\n\n  loadMorePhotos() {\n    this.searchParams.page += 1;\n    this.fetchPhotos();\n  },\n\n  renderPhotos(photos) {\n    if (photos.total === 0) {\n      this.showAlert(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      this.showLoaderAndButtons(false);\n      return;\n    }\n    this.totalHits = photos.totalHits;\n    const markup = photos.hits\n      .map(photo => {\n        return `<a class=\"gallery-link\" href=\"${photo.largeImageURL}\">\n                <span class=\"gallery-item\"><img class=\"gallery-image\" src=\"${photo.webformatURL}\" alt=\"${photo.tags}\" title=\"${photo.tags}\" /></span>\n                <span class=\"img-stat\">\n                <span class=\"img-stat-item\"><span class=\"img-stat-title\">Likes</span><span class=\"img-stat-val\">${photo.likes}</span></span>\n                <span class=\"img-stat-item\"><span class=\"img-stat-title\">Views</span><span class=\"img-stat-val\">${photo.views}</span></span>\n                <span class=\"img-stat-item\"><span class=\"img-stat-title\">Comments</span><span class=\"img-stat-val\">${photo.comments}</span></span>\n                <span class=\"img-stat-item\"><span class=\"img-stat-title\">Downloads</span><span class=\"img-stat-val\">${photo.downloads}</span></span>\n                </span>\n                </a>`;\n      })\n      .join('');\n    this.gallery.insertAdjacentHTML('beforeend', markup);\n    this.simpleGallery.refresh();\n    this.scrollTop();\n  },\n\n  scrollTop() {\n    if (this.searchParams.page > 1) {\n      const rect = document\n        .querySelector('.gallery-link')\n        .getBoundingClientRect();\n      window.scrollBy({ top: rect.height * 2, left: 0, behavior: 'smooth' });\n    }\n  },\n\n  showLoaderAndButtons(state = true) {\n    this.loader.style.display = !state ? 'none' : 'inline-block';\n    getMoreBtn.style.display = !state ? 'block' : 'none';\n    this.searchPhotosBtn.disabled = state;\n    if (state === false) {\n      if (this.searchParams.page === 1 && this.totalHits > 1) {\n        getMoreBtn.style.display = 'block';\n      }\n      if (\n        Math.ceil(this.totalHits / this.searchParams.per_page) ===\n        this.searchParams.page\n      ) {\n        getMoreBtn.style.display = 'none';\n        this.showAlert(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n    }\n  },\n\n  showAlert(msg) {\n    iziToast.show({\n      position: 'center',\n      iconUrl: alertImg,\n      messageColor: '#FAFAFB',\n      messageSize: '16px',\n      backgroundColor: '#EF4040',\n      close: false,\n      closeOnClick: true,\n      message: msg,\n    });\n  },\n\n  async fetchPhotos() {\n    this.showLoaderAndButtons();\n    try {\n      const response = await axios.get(this.url, { params: this.searchParams });\n      this.renderPhotos(response.data);\n    } catch (error) {\n      this.showAlert(error.message);\n    }\n    this.showLoaderAndButtons(false);\n  },\n};\n\nform.addEventListener('submit', event => photoLoader.startSearch(event));\n\nif (getMoreBtn) {\n  getMoreBtn.addEventListener('click', () => photoLoader.loadMorePhotos());\n}\n"],"names":["alertImg","form","getMoreBtn","photoLoader","SimpleLightbox","event","photos","markup","photo","rect","state","msg","iziToast","response","axios","error"],"mappings":"owBAAA,MAAeA,EAAA,2CCOTC,EAAO,SAAS,cAAc,OAAO,EACrCC,EACJ,SAAS,cAAc,eAAe,GAAK,SAAS,cAAc,QAAQ,EAEtEC,EAAc,CAClB,IAAK,2BACL,aAAc,CACZ,IAAK,qCACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAM,CACP,EACD,gBAAiB,SAAS,cAAc,aAAa,EACrD,WAAY,SAAS,cAAc,aAAa,EAChD,OAAQ,SAAS,cAAc,SAAS,EACxC,QAAS,SAAS,cAAc,UAAU,EAC1C,UAAW,EAEX,cAAe,IAAIC,EAAe,aAAc,CAC9C,eAAgB,GAChB,aAAc,MACd,aAAc,GAClB,CAAG,EAED,YAAYC,EAAO,CAEjB,GADAA,EAAM,eAAc,EAChB,KAAK,WAAW,MAAM,KAAM,EAAC,OAAS,EAAG,CAC3C,KAAK,UAAU,4BAA4B,EAC3C,MACD,CACD,KAAK,QAAQ,UAAY,GACzB,KAAK,aAAa,EAAI,KAAK,WAAW,MAAM,OAC5C,KAAK,aAAa,KAAO,EACzB,KAAK,YAAW,CACjB,EAED,gBAAiB,CACf,KAAK,aAAa,MAAQ,EAC1B,KAAK,YAAW,CACjB,EAED,aAAaC,EAAQ,CACnB,GAAIA,EAAO,QAAU,EAAG,CACtB,KAAK,UACH,0EACR,EACM,KAAK,qBAAqB,EAAK,EAC/B,MACD,CACD,KAAK,UAAYA,EAAO,UACxB,MAAMC,EAASD,EAAO,KACnB,IAAIE,GACI,iCAAiCA,EAAM;AAAA,6EACuBA,EAAM,sBAAsBA,EAAM,gBAAgBA,EAAM;AAAA;AAAA,kHAEnBA,EAAM;AAAA,kHACNA,EAAM;AAAA,qHACHA,EAAM;AAAA,sHACLA,EAAM;AAAA;AAAA,qBAGrH,EACA,KAAK,EAAE,EACV,KAAK,QAAQ,mBAAmB,YAAaD,CAAM,EACnD,KAAK,cAAc,UACnB,KAAK,UAAS,CACf,EAED,WAAY,CACV,GAAI,KAAK,aAAa,KAAO,EAAG,CAC9B,MAAME,EAAO,SACV,cAAc,eAAe,EAC7B,wBACH,OAAO,SAAS,CAAE,IAAKA,EAAK,OAAS,EAAG,KAAM,EAAG,SAAU,QAAU,CAAA,CACtE,CACF,EAED,qBAAqBC,EAAQ,GAAM,CACjC,KAAK,OAAO,MAAM,QAAWA,EAAiB,eAAT,OACrCR,EAAW,MAAM,QAAWQ,EAAkB,OAAV,QACpC,KAAK,gBAAgB,SAAWA,EAC5BA,IAAU,KACR,KAAK,aAAa,OAAS,GAAK,KAAK,UAAY,IACnDR,EAAW,MAAM,QAAU,SAG3B,KAAK,KAAK,KAAK,UAAY,KAAK,aAAa,QAAQ,IACrD,KAAK,aAAa,OAElBA,EAAW,MAAM,QAAU,OAC3B,KAAK,UACH,4DACV,GAGG,EAED,UAAUS,EAAK,CACbC,EAAS,KAAK,CACZ,SAAU,SACV,QAASZ,EACT,aAAc,UACd,YAAa,OACb,gBAAiB,UACjB,MAAO,GACP,aAAc,GACd,QAASW,CACf,CAAK,CACF,EAED,MAAM,aAAc,CAClB,KAAK,qBAAoB,EACzB,GAAI,CACF,MAAME,EAAW,MAAMC,EAAM,IAAI,KAAK,IAAK,CAAE,OAAQ,KAAK,YAAY,CAAE,EACxE,KAAK,aAAaD,EAAS,IAAI,CAChC,OAAQE,EAAP,CACA,KAAK,UAAUA,EAAM,OAAO,CAC7B,CACD,KAAK,qBAAqB,EAAK,CAChC,CACH,EAEAd,EAAK,iBAAiB,SAAUI,GAASF,EAAY,YAAYE,CAAK,CAAC,EAEnEH,GACFA,EAAW,iBAAiB,QAAS,IAAMC,EAAY,eAAgB,CAAA"}